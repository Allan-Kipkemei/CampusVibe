{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport React, { useEffect, useState, useCallback } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Snippet from \"../components/snippet\";\nimport { useSelector } from 'react-redux';\nimport { db } from \"../firebase/firebase\";\nimport { collection, query, where, onSnapshot, orderBy } from 'firebase/firestore';\nimport { Picker } from \"@react-native-picker/picker\";\nimport { FontAwesome } from '@expo/vector-icons';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar Posts = function Posts(_ref) {\n  var setTopicCount = _ref.setTopicCount,\n    userId = _ref.userId;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    posts = _useState2[0],\n    setPosts = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    pinnedPosts = _useState4[0],\n    setPinnedPosts = _useState4[1];\n  var _useState5 = useState('latest'),\n    _useState6 = _slicedToArray(_useState5, 2),\n    sortingOption = _useState6[0],\n    setSortingOption = _useState6[1];\n  var userProfile = useSelector(function (state) {\n    return state.userProfile;\n  });\n  useEffect(function () {\n    var postsQuery;\n    var pinnedPostsQuery;\n    var fetchPosts = function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        pinnedPostsQuery = query(collection(db, 'Posts'), where('userId', '==', userId), where('pinned', '==', true), orderBy('createdAt', 'desc'));\n        switch (sortingOption) {\n          case 'latest':\n            postsQuery = query(collection(db, 'Posts'), where('userId', '==', userId), where('pinned', '==', false), orderBy('pinned', 'desc'), orderBy('createdAt', 'desc'));\n            break;\n          case 'earliest':\n            postsQuery = query(collection(db, 'Posts'), where('userId', '==', userId), where('pinned', '==', false), orderBy('pinned', 'desc'), orderBy('createdAt', 'asc'));\n            break;\n          case 'top':\n            postsQuery = query(collection(db, 'Posts'), where('userId', '==', userId), where('pinned', '==', false), orderBy('pinned', 'desc'), orderBy('likes', 'desc'));\n            break;\n          default:\n            postsQuery = query(collection(db, 'Posts'), where('userId', '==', userId), where('pinned', '==', false), orderBy('pinned', 'desc'), orderBy('createdAt', 'desc'));\n        }\n        var unsubscribePosts = onSnapshot(postsQuery, function (querySnapshot) {\n          var fetchedPosts = [];\n          querySnapshot.forEach(function (doc) {\n            fetchedPosts.push(_objectSpread({\n              id: doc.id\n            }, doc.data()));\n          });\n          setPosts(fetchedPosts);\n          setTopicCount(querySnapshot.size);\n        });\n        var unsubscribePinnedPosts = onSnapshot(pinnedPostsQuery, function (querySnapshot) {\n          var fetchedPinnedPosts = [];\n          querySnapshot.forEach(function (doc) {\n            fetchedPinnedPosts.push(_objectSpread({\n              id: doc.id\n            }, doc.data()));\n          });\n          setPinnedPosts(fetchedPinnedPosts);\n        });\n        return function () {\n          unsubscribePosts();\n          unsubscribePinnedPosts();\n        };\n      });\n      return function fetchPosts() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    fetchPosts();\n  }, [sortingOption, userId]);\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsxs(View, {\n      style: styles.sort,\n      children: [_jsx(Text, {\n        style: styles.header,\n        children: \"Sort\"\n      }), _jsxs(Picker, {\n        style: styles.picker,\n        selectedValue: sortingOption,\n        onValueChange: function onValueChange(itemValue) {\n          return setSortingOption(itemValue);\n        },\n        children: [_jsx(Picker.Item, {\n          label: \"Latest\",\n          value: \"latest\",\n          style: styles.pickerItem\n        }), _jsx(Picker.Item, {\n          label: \"Earliest\",\n          value: \"earliest\",\n          style: styles.pickerItem\n        }), _jsx(Picker.Item, {\n          label: \"Top\",\n          value: \"top\",\n          style: styles.pickerItem\n        })]\n      })]\n    }), _jsx(FlatList, {\n      data: [].concat(_toConsumableArray(pinnedPosts), _toConsumableArray(posts)),\n      renderItem: function renderItem(_ref3) {\n        var item = _ref3.item;\n        return _jsx(Snippet, {\n          post: item,\n          postId: item.id\n        });\n      },\n      keyExtractor: function keyExtractor(item) {\n        return item.id.toString();\n      },\n      scrollEnabled: false,\n      contentContainerStyle: styles.flatListContent\n    })]\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    backgroundColor: '#fafafa'\n  },\n  sort: {\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    flexDirection: 'row',\n    paddingHorizontal: 20,\n    height: 35,\n    backgroundColor: '#fafafa',\n    elevation: 1\n  },\n  picker: {\n    width: 120\n  },\n  pickerItem: {\n    fontSize: 13,\n    color: '#a0a0a0',\n    fontWeight: '500'\n  }\n});\nexport default Posts;","map":{"version":3,"names":["React","useEffect","useState","useCallback","View","StyleSheet","FlatList","Text","Snippet","useSelector","db","collection","query","where","onSnapshot","orderBy","Picker","FontAwesome","jsx","_jsx","jsxs","_jsxs","Posts","_ref","setTopicCount","userId","_useState","_useState2","_slicedToArray","posts","setPosts","_useState3","_useState4","pinnedPosts","setPinnedPosts","_useState5","_useState6","sortingOption","setSortingOption","userProfile","state","postsQuery","pinnedPostsQuery","fetchPosts","_ref2","_asyncToGenerator","unsubscribePosts","querySnapshot","fetchedPosts","forEach","doc","push","_objectSpread","id","data","size","unsubscribePinnedPosts","fetchedPinnedPosts","apply","arguments","style","styles","container","children","sort","header","picker","selectedValue","onValueChange","itemValue","Item","label","value","pickerItem","concat","_toConsumableArray","renderItem","_ref3","item","post","postId","keyExtractor","toString","scrollEnabled","contentContainerStyle","flatListContent","create","backgroundColor","alignItems","justifyContent","flexDirection","paddingHorizontal","height","elevation","width","fontSize","color","fontWeight"],"sources":["/home/leo/Documents/Campus-Vibes-V1/mobile/screens/Posts.js"],"sourcesContent":["import React, { useEffect, useState, useCallback} from 'react';\nimport { View, StyleSheet, FlatList, Text } from 'react-native';\nimport Snippet from '../components/snippet';\nimport { useSelector } from 'react-redux';\nimport { db } from '../firebase/firebase';\nimport { collection, query, where, onSnapshot, orderBy } from 'firebase/firestore';\nimport { Picker } from \"@react-native-picker/picker\";\nimport { FontAwesome } from '@expo/vector-icons'\n\n\nconst Posts = ({ setTopicCount, userId }) => {\n  const [posts, setPosts] = useState([]);\n  const [pinnedPosts, setPinnedPosts] = useState([]);\n  const [sortingOption, setSortingOption] = useState('latest');\n  const userProfile = useSelector((state) => state.userProfile);\n\n  useEffect(() => {\n    let postsQuery;\n    let pinnedPostsQuery;\n\n    const fetchPosts = async () => {\n      // Query for pinned posts\n      pinnedPostsQuery = query(\n        collection(db, 'Posts'),\n        where('userId', '==', userId),\n        where('pinned', '==', true),\n        orderBy('createdAt', 'desc')\n      );\n\n      // Query for regular posts based on the selected sorting option\n      switch (sortingOption) {\n        case 'latest':\n          postsQuery = query(\n            collection(db, 'Posts'),\n            where('userId', '==', userId),\n            where('pinned', '==', false),\n            orderBy('pinned', 'desc'),\n            orderBy('createdAt', 'desc')\n          );\n          break;\n        case 'earliest':\n          postsQuery = query(\n            collection(db, 'Posts'),\n            where('userId', '==', userId),\n            where('pinned', '==', false),\n            orderBy('pinned', 'desc'),\n            orderBy('createdAt', 'asc')\n          );\n          break;\n        case 'top':\n          postsQuery = query(\n            collection(db, 'Posts'),\n            where('userId', '==', userId),\n            where('pinned', '==', false),\n            orderBy('pinned', 'desc'),\n            orderBy('likes', 'desc')\n          );\n          break;\n        default:\n          postsQuery = query(\n            collection(db, 'Posts'),\n            where('userId', '==', userId),\n            where('pinned', '==', false),\n            orderBy('pinned', 'desc'),\n            orderBy('createdAt', 'desc')\n          );\n      }\n\n      const unsubscribePosts = onSnapshot(postsQuery, (querySnapshot) => {\n        const fetchedPosts = [];\n        querySnapshot.forEach((doc) => {\n          fetchedPosts.push({ id: doc.id, ...doc.data() });\n        });\n        setPosts(fetchedPosts);\n        setTopicCount(querySnapshot.size);\n      });\n\n      const unsubscribePinnedPosts = onSnapshot(pinnedPostsQuery, (querySnapshot) => {\n        const fetchedPinnedPosts = [];\n        querySnapshot.forEach((doc) => {\n          fetchedPinnedPosts.push({ id: doc.id, ...doc.data() });\n        });\n        setPinnedPosts(fetchedPinnedPosts);\n      });\n\n      return () => {\n        unsubscribePosts();\n        unsubscribePinnedPosts();\n      };\n    };\n\n    fetchPosts();\n  }, [sortingOption, userId]);\n\n  return (\n    <View style={styles.container}>\n      <View style={styles.sort}>\n        <Text style={styles.header}>Sort</Text>\n        <Picker\n          style={styles.picker}\n          selectedValue={sortingOption}\n          onValueChange={(itemValue) => setSortingOption(itemValue)}\n        >\n          <Picker.Item label=\"Latest\" value=\"latest\" style={styles.pickerItem} />\n          <Picker.Item label=\"Earliest\" value=\"earliest\" style={styles.pickerItem} />\n          <Picker.Item label=\"Top\" value=\"top\" style={styles.pickerItem} />\n        </Picker>\n      </View>\n      <FlatList\n        data={[...pinnedPosts, ...posts]}\n        renderItem={({ item }) => <Snippet post={item} postId={item.id} />}\n        keyExtractor={(item) => item.id.toString()} // Convert id to string to avoid duplicate key warning\n        scrollEnabled={false}\n        contentContainerStyle={styles.flatListContent}\n      />\n    </View>\n  );\n};\n\n\nconst styles = StyleSheet.create({\n  container:{\n    backgroundColor: '#fafafa'\n  },\n\n  sort:{\n    // borderWidth: 1,\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    flexDirection: 'row',\n    paddingHorizontal: 20,\n    height:35,\n    backgroundColor: '#fafafa', elevation: 1,\n  },\n  picker:{\n    width: 120\n  },\n  pickerItem: {\n    fontSize: 13, \n    color: '#a0a0a0', fontWeight: '500'\n  },\n\n});\n\nexport default Posts;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}