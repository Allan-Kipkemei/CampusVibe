{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport React, { useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { db } from \"../firebase/firebase\";\nimport { collection, query, where, onSnapshot, doc } from 'firebase/firestore';\nimport { Feather } from '@expo/vector-icons';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nvar SearchResults = function SearchResults(_ref) {\n  var query = _ref.query;\n  var _useState = useState(['university']),\n    _useState2 = _slicedToArray(_useState, 2),\n    matchingPosts = _useState2[0],\n    setMatchingPosts = _useState2[1];\n  var seachResult = query;\n  console.log(query);\n  console.log;\n  useEffect(function () {\n    var fetchMatchingPosts = function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        var postsRef = collection(db, 'Posts');\n        var queryArray = typeof query === 'string' ? query.split(' ') : [];\n        var queryRefs = queryArray.map(function (q) {\n          return q.trim().toLowerCase();\n        });\n        if (queryRefs.length < 3) {\n          setMatchingPosts([]);\n          return;\n        }\n        var matchingPostsQuery = query(postsRef, where('topic', 'array-contains-any', queryRefs), where('message', 'array-contains-any', queryRefs), where('imageTag', 'array-contains-any', queryRefs));\n        var unsubscribe = onSnapshot(matchingPostsQuery, function (querySnapshot) {\n          var posts = [];\n          querySnapshot.forEach(function (doc) {\n            posts.push(_objectSpread({\n              id: doc.id\n            }, doc.data()));\n          });\n          setMatchingPosts(posts);\n        }, function (error) {\n          console.log('Error getting matching posts: ', error);\n        });\n        return unsubscribe;\n      });\n      return function fetchMatchingPosts() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    fetchMatchingPosts();\n  }, [query]);\n  return _jsx(View, {\n    style: styles.body,\n    children: matchingPosts.length > 0 ? _jsxs(_Fragment, {\n      children: [_jsxs(View, {\n        style: styles.searchbox,\n        children: [_jsx(View, {\n          style: styles.profile,\n          children: _jsx(Feather, {\n            name: \"search\",\n            size: 24,\n            color: \"black\"\n          })\n        }), _jsx(View, {\n          style: styles.searchbody,\n          children: _jsx(Text, {\n            style: styles.searchtext,\n            children: seachResult\n          })\n        })]\n      }), _jsx(FlatList, {\n        data: matchingPosts,\n        keyExtractor: function keyExtractor(item) {\n          return item.id;\n        },\n        renderItem: function renderItem(_ref3) {\n          var item = _ref3.item;\n          return _jsxs(View, {\n            style: styles.searchbox,\n            children: [_jsx(View, {\n              style: styles.profile,\n              children: item.profile ? _jsx(Image, {\n                style: styles.profile,\n                source: {\n                  uri: item.profileImageUri\n                }\n              }) : _jsx(Feather, {\n                name: \"search\",\n                size: 24,\n                color: \"black\"\n              })\n            }), _jsx(View, {\n              style: styles.searchbody,\n              children: _jsx(Text, {\n                style: styles.searchtext,\n                children: item.topic\n              })\n            })]\n          });\n        }\n      })]\n    }) : _jsx(Text, {\n      children: null\n    })\n  });\n};\nvar styles = StyleSheet.create({\n  body: {\n    position: 'absolute',\n    top: 80,\n    left: 0,\n    right: 0,\n    bottom: 0\n  },\n  searchbox: {\n    paddingHorizontal: 10,\n    flexDirection: 'row'\n  }\n});\nexport default SearchResults;","map":{"version":3,"names":["React","useState","useEffect","View","Text","FlatList","StyleSheet","db","collection","query","where","onSnapshot","doc","Feather","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SearchResults","_ref","_useState","_useState2","_slicedToArray","matchingPosts","setMatchingPosts","seachResult","console","log","fetchMatchingPosts","_ref2","_asyncToGenerator","postsRef","queryArray","split","queryRefs","map","q","trim","toLowerCase","length","matchingPostsQuery","unsubscribe","querySnapshot","posts","forEach","push","_objectSpread","id","data","error","apply","arguments","style","styles","body","children","searchbox","profile","name","size","color","searchbody","searchtext","keyExtractor","item","renderItem","_ref3","Image","source","uri","profileImageUri","topic","create","position","top","left","right","bottom","paddingHorizontal","flexDirection"],"sources":["/home/leo/Documents/Campus-Vibes-V1/mobile/components/searchResults.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { View, Text, FlatList, StyleSheet} from 'react-native';\nimport { db } from '../firebase/firebase';\nimport { collection, query, where, onSnapshot, doc } from 'firebase/firestore';\nimport { Feather } from '@expo/vector-icons';\n\n\nconst SearchResults = ({ query }) => {\n  const [matchingPosts, setMatchingPosts] = useState(['university']);\n  const seachResult = query;\n  console.log(query)\n  console.log\n\n  useEffect(() => {\n    const fetchMatchingPosts = async () => {\n      const postsRef = collection(db, 'Posts');\n      const queryArray = typeof query === 'string' ? query.split(' ') : [];\n      const queryRefs = queryArray.map(q => q.trim().toLowerCase());\n\n\n      if (queryRefs.length < 3) {\n        // If query is less than 3 characters, set matchingPosts to an empty array\n        setMatchingPosts([]);\n        return;\n      }\n  \n      const matchingPostsQuery = query(\n        postsRef,\n        where('topic', 'array-contains-any', queryRefs),\n        where('message', 'array-contains-any', queryRefs),\n        where('imageTag', 'array-contains-any', queryRefs)\n      );\n  \n      const unsubscribe = onSnapshot(matchingPostsQuery, (querySnapshot) => {\n        const posts = [];\n        querySnapshot.forEach((doc) => {\n          posts.push({ id: doc.id, ...doc.data() });\n        });\n        setMatchingPosts(posts);\n      }, (error) => {\n        console.log('Error getting matching posts: ', error);\n      });\n  \n      return unsubscribe;\n    };\n  \n    fetchMatchingPosts();\n  }, [query]);\n  \n\n  return (\n    <View style={styles.body}>\n      \n      {matchingPosts.length > 0 ? (\n        <>\n        <View style={styles.searchbox}>\n           <View style={styles.profile}>\n              <Feather name=\"search\" size={24} color=\"black\"/>\n           </View>\n           <View style={styles.searchbody}>\n              <Text style={styles.searchtext}>{seachResult}</Text>\n            </View>\n         </View>\n          <FlatList\n             data={matchingPosts}\n             keyExtractor={(item) => item.id}\n             renderItem={({ item }) => (\n              <View style={styles.searchbox}>\n                <View style={styles.profile}>\n                  {item.profile?(\n                    <Image\n                        style={styles.profile}\n                        source={{uri: item.profileImageUri}}\n                      />\n                  ) : (\n                    <Feather name=\"search\" size={24} color=\"black\"/>\n                  )}\n                 </View>\n                <View style={styles.searchbody}>\n                  <Text style={styles.searchtext}>{item.topic}</Text>\n                </View>\n              </View>\n          )}\n        />\n      </>\n      ) : (\n     <Text>{null}</Text>\n       )}\n\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  body:{\n    position: 'absolute',top: 80,\n    left: 0, right: 0, bottom: 0\n  },\n  searchbox:{\n    paddingHorizontal: 10,\n    flexDirection: 'row'\n  }\n});\n\nexport default SearchResults;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}